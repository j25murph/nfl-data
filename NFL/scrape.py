import requests
from bs4 import BeautifulSoup
import numpy as np
import pandas as pd

pages=["https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingyards/desc","https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingYards/DESC?aftercursor=0000001900000000008500100079000840883800000000006e00000005000000045f74626c00000010706572736f6e5f7465616d5f737461740000000565736249640000000953494e31383639313900000004726f6c6500000003504c5900000008736561736f6e496400000004323031390000000a736561736f6e5479706500000003524547f07fffffe6f07fffffe691de5008d799f9ba761cb0a998ca30040004","https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingYards/DESC?aftercursor=0000003200000000008500100079000840793000000000006e00000005000000045f74626c00000010706572736f6e5f7465616d5f73746174000000056573624964000000094a4f4833393931383800000004726f6c6500000003504c5900000008736561736f6e496400000004323031390000000a736561736f6e5479706500000003524547f07fffffcdf07fffffcd75bd852c8248425583f5246940da9d5d0004","https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingYards/DESC?aftercursor=0000004b000000000085001000790008406c2000000000006e00000005000000045f74626c00000010706572736f6e5f7465616d5f737461740000000565736249640000000948494c33323633303100000004726f6c6500000003504c5900000008736561736f6e496400000004323031390000000a736561736f6e5479706500000003524547f07fffffb4f07fffffb46c57d73d1a41485d2cb3833eed3d21a50004","https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingYards/DESC?aftercursor=000000640000000000850010007900084060e000000000006e00000005000000045f74626c00000010706572736f6e5f7465616d5f737461740000000565736249640000000942414c36303836373700000004726f6c6500000003504c5900000008736561736f6e496400000004323031390000000a736561736f6e5479706500000003524547f07fffff9bf07fffff9bb76a5e54257e966e9a2585b4975f80720004","https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingYards/DESC?aftercursor=0000007d00000000008500100079000840534000000000006e00000005000000045f74626c00000010706572736f6e5f7465616d5f737461740000000565736249640000000946494e34313232363900000004726f6c6500000003504c5900000008736561736f6e496400000004323031390000000a736561736f6e5479706500000003524547f07fffff82f07fffff82de6b4c2083cad60d82a2a9cb9a4fbc840004","https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingYards/DESC?aftercursor=0000009600000000008500100079000840488000000000006e00000005000000045f74626c00000010706572736f6e5f7465616d5f737461740000000565736249640000000948494c37313435333600000004726f6c6500000003504c5900000008736561736f6e496400000004323031390000000a736561736f6e5479706500000003524547f07fffff69f07fffff694c756761f847d11f3350d9467b29a87a0004","https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingYards/DESC?aftercursor=000000af000000000085001000790008403d0000000000006e00000005000000045f74626c00000010706572736f6e5f7465616d5f737461740000000565736249640000000952495636353136333400000004726f6c6500000003504c5900000008736561736f6e496400000004323031390000000a736561736f6e5479706500000003524547f07fffff50f07fffff5074f74fd066b8464b3239bcb673402b4c0004","https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingYards/DESC?aftercursor=000000c800000000008500100079000840320000000000006e00000005000000045f74626c00000010706572736f6e5f7465616d5f7374617400000005657362496400000009524f4731343637343200000004726f6c6500000003504c5900000008736561736f6e496400000004323031390000000a736561736f6e5479706500000003524547f07fffff37f07fffff379f87926f923c8149d0b2b6572b659aea0004","https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingYards/DESC?aftercursor=000000e100000000008500100079000840260000000000006e00000005000000045f74626c00000010706572736f6e5f7465616d5f737461740000000565736249640000000953414e38303834343700000004726f6c6500000003504c5900000008736561736f6e496400000004323031390000000a736561736f6e5479706500000003524547f07fffff1ef07fffff1e4f6252539a31481bf12b2967b4d880150004","https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingYards/DESC?aftercursor=000000fa000000000085001000790008401c0000000000006e00000005000000045f74626c00000010706572736f6e5f7465616d5f7374617400000005657362496400000009524f4537353033383100000004726f6c6500000003504c5900000008736561736f6e496400000004323031390000000a736561736f6e5479706500000003524547f07fffff05f07fffff05ce57db916e825a91f3ec3837e1ffc4210004","https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingYards/DESC?aftercursor=0000011300000000008500100079000840140000000000006e00000005000000045f74626c00000010706572736f6e5f7465616d5f737461740000000565736249640000000947524134343338383900000004726f6c6500000003504c5900000008736561736f6e496400000004323031390000000a736561736f6e5479706500000003524547f07ffffeecf07ffffeec6f4d6f89158b6cf05896b68098aa75030004","https://www.nfl.com/stats/player-stats/category/rushing/2019/REG/all/rushingYards/DESC?aftercursor=0000012c0000000000850010007900083ff00000000000006e00000005000000045f74626c00000010706572736f6e5f7465616d5f73746174000000056573624964000000094d435334313039363500000004726f6c6500000003504c5900000008736561736f6e496400000004323031390000000a736561736f6e5479706500000003524547f07ffffed3f07ffffed3a7c015b921f9b483c18a34f043aae28c0004"]
stats = []
yards = []
for page in pages:
    r = requests.get(page)
    c = r.content
    
    soup=BeautifulSoup(c,"html.parser")
    all = soup.find_all("td",{"class":""})
    
    for item in all:
        j = item.text.replace("\n","").strip()
        stats.append(j)
        
    yards_all = soup.find_all("td",{"class":"selected"})
    for item in yards_all:
        j = item.text.replace("\n","").strip()
        yards.append(j)

    arr = np.array(stats)
x = arr.reshape(304,9)
df = pd.DataFrame(x, columns=['Name','Attempts','Touchdowns','20+','40+','Lng','Rush 1st','Rush 1st%','Rush FUM'])
df.insert(1,"Yards",yards, True)